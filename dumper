-- save original functions
local old_unpack = unpack
local old_appendfile = appendfile

local output = "yes.txt"
local Credits = "Dumped with your unpack hook"

-- safer append wrapper
local function append_wrapped(filename, content)
    -- create file with credits once
    if not isfile(filename) then
        writefile(filename, Credits .. "\n")
    end

    -- now append content
    return old_appendfile(filename, content)
end

-- pretty format any table
local function format_table(tab, indent)
    indent = indent or ""
    local next_indent = indent .. "  "

    local result = "{\n"
    for index, value in pairs(tab) do
        if type(value) == "table" then
            result = result .. string.format(
                "%s[Index: %s] = %s\n",
                next_indent,
                tostring(index),
                format_table(value, next_indent)
            )
        else
            result = result .. string.format(
                "%s[Index: %s] = %s,\n",
                next_indent,
                tostring(index),
                tostring(value)
            )
        end
    end
    result = result .. indent .. "}"
    return result
end

-- dump a table (or multiple tables) to file
local function dump_value(v)
    if type(v) == "table" then
        append_wrapped(output, format_table(v) .. "\n\n")
    else
        append_wrapped(output, string.format("{ Value = %s }\n", tostring(v)))
    end
end

local function dump_results(results)
    for i = 1, #results do
        dump_value(results[i])
    end
end

-- hook unpack
function unpack(...)
    -- call the original once and capture ALL returns
    local results = { old_unpack(...) }

    -- you can choose how aggressive you want to be:
    -- here we only inspect the first result (common pattern)
    if type(results[1]) == "table" then
        dump_results(results)
    end

    -- return original unpack results
    return table.unpack(results)
end

-- finally, run the obfuscated / remote script
loadstring(game:HttpGet("https://raw.githubusercontent.com/MajestySkie/Fish-It/refs/heads/main/Memancing.lua"))()
